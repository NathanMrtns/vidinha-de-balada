cota_mensal = c(44632.46,
40944.10,
43570.12,
43374.78,
39010.85,
42451.77,
30788.66,
37423.91,
35507.06,
42151.69,
36092.71,
40542.84,
39428.03,
42227.45,
42032.56,
41676.80,
40971.77,
38871.86,
35759.97,
42731.99,
43672.49,
45612.53,
40875.90,
39877.78,
40139.26,
37043.53,
39503.61)
cotas$cota_mensal = cota_mensal
source('~/Desktop/projetos/vidinha-de-balada/script/gera_csvs.R')
source("formata_dados.R")
source("prepara_gastos.R")
options(scipen = 50)
library(readr)
dados_gastos = cria_data_frame_2015_2017()
dados = dados_gastos
cotas = read_csv("../data/final/cota_por_estado.csv")
votacoes = read_csv("../data/final/votacoes2.csv")
tabela_final_mensal = cria_tabela_final_mensal(dados_gastos)
write.csv(tabela_final_mensal, "tabela_final_mensal.csv", row.names = F)
tabela_final_categoria = cria_tabela_final_categoria(dados_gastos)
write.csv(tabela_final_categoria, "tabela_final_categoria.csv", row.names = F)
tabela_final_votacoes = cria_tabela_final_votacoes(votacoes)
write.csv(tabela_final_votacoes, "tabela_final_votacoes.csv", row.names = F)
tabela_gastos_presenca = cria_tabela_gastos_presenca(tabela_final_votacoes, tabela_final_mensal)
write.csv(tabela_gastos_presenca, "tabela_gastos_presenca.csv", row.names = F)
tabela_gasto_total_anos = cria_tabela_gasto_total_anos(tabela_final_mensal)
write.csv(tabela_gasto_total_anos, "tabela_gasto_total_anos.csv", row.names = F)
tabela_6_gastos = cria_tabela_6_gastos(dados_gastos)
write.csv(tabela_6_gastos, "tabela_6_gastos.csv", row.names = F)
tabela_6_gastos_mensal = cria_tabela_6_gastos(dados_gastos)
write.csv(tabela_6_gastos_mensal, "tabela_6_gastos_mensal.csv", row.names = F)
top_estourados = cria_top_estourados(tabela_final_mensal)
write.csv(top_estourados, "top_estourados.csv", row.names = F)
for(i in 1:NROW(cotas)){
temp = cria_top_estourados_estado(cotas$sgUF[i], tabela_final_mensal)
uf = cotas$sgUF[i]
write.csv(temp, paste("top_10_estourados_", uf, ".csv", sep=""), row.names = F)
}
dado = cria_data_frame_2015_2017()
source("formata_dados.R")
source("prepara_gastos.R")
options(scipen = 50)
library(readr)
dados = cria_data_frame_2015_2017()
cotas = read_csv("../data/final/cota_por_estado.csv")
votacoes = read_csv("../data/final/votacoes2.csv")
dados = cria_data_frame_2015_2017()
dados = cria_data_frame_2015_2017()
dados = cria_data_frame_2015_2017()
tabela_final_mensal = cria_tabela_final_mensal(dados_gastos)
tabela_final_mensal = dados %>%
filter(vlrLiquido > 0) %>%
select(txNomeParlamentar, idecadastro, sgUF,  numAno, numMes, vlrLiquido) %>%
group_by(txNomeParlamentar, idecadastro, sgUF, numAno, numMes) %>%
summarise(total = sum(vlrLiquido)) %>%
na.omit() %>%
inner_join(cotas) %>%
mutate(coef = total/cota_mensal)
tabela_final_categoria = dados %>%
filter(vlrLiquido > 0) %>%
select(txNomeParlamentar, idecadastro, sgUF, numAno, numMes, nossas_categorias, vlrLiquido) %>%
group_by(txNomeParlamentar, idecadastro, sgUF, numAno, numMes, nossas_categorias) %>%
summarise(total = sum(vlrLiquido)) %>%
na.omit() %>%
inner_join(cotas) %>%
mutate(coef = total/cota_mensal)
votacoes = votacoes %>%
group_by(id_dep) %>%
mutate(nome = first(nome))
votacoes = read_csv("../data/final/votacoes2.csv")
votacoes = votacoes %>%
group_by(id_dep) %>%
mutate(nome = first(nome))
View(votacoes)
votacoes = votacoes %>%
group_by(id_dep, anov, mesv, diav) %>%
arrange(id_dep, anov, mesv, diav)
votacoes = read_csv("../data/final/votacoes2.csv")
votacoes = votacoes %>%
arrange(id_dep, anov, mesv, diav)
votacoes = votacoes %>%
arrange(id_dep, anov, mesv, -diav)
votacoes = votacoes %>%
arrange(id_dep, anov, mesv, -diav) %>%
group_by(id_dep, anov, mesv, diav) %>%
mutate(partido = first(partido))
votacoes = votacoes %>%
arrange(id_dep, anov, mesv, -diav) %>%
group_by(id_dep, anov, mesv) %>%
mutate(partido = first(partido))
votacoes = read_csv("../data/final/votacoes2.csv")
votacoes = votacoes %>%
group_by(id_dep) %>%
mutate(nome = first(nome))
sessoes = votacoes %>%
filter(anov > 2014) %>%
group_by(anov, mesv, diav) %>%
distinct() %>%
group_by(anov, mesv) %>%
summarise(total_mes = n())
tabela_final_votacoes = votacoes %>%
filter(anov > 2014) %>%
group_by(nome, id_dep, uf, anov, mesv, diav) %>%
distinct() %>%
group_by(nome, id_dep, uf, anov, mesv) %>%
summarise(total_deputado = n()) %>%
inner_join(sessoes) %>%
mutate(coef = total_deputado/total_mes)
View(tabela_final_votacoes)
votacoes = votacoes %>%
arrange(id_dep, anov, mesv, -diav) %>%
group_by(id_dep, anov, mesv) %>%
mutate(partido = first(partido))
sessoes = votacoes %>%
filter(anov > 2014) %>%
group_by(anov, mesv, diav) %>%
distinct() %>%
group_by(anov, mesv) %>%
summarise(total_mes = n())
tabela_final_votacoes = votacoes %>%
filter(anov > 2014) %>%
group_by(nome, id_dep, partido, uf, anov, mesv, diav) %>%
distinct() %>%
group_by(nome, id_dep, partido, uf, anov, mesv) %>%
summarise(total_deputado = n()) %>%
inner_join(sessoes) %>%
mutate(coef = total_deputado/total_mes)
votacoes = read_csv("../data/final/votacoes2.csv")
names(tabela_final_mensal) = c("nome", "id", "uf", "ano", "mes", "total_gasto", "cota_mensal", "coef_gasto")
names(tabela_final_votacoes) = c("nome", "id", "partido", "uf","ano", "mes", "total_presenca", "total_mes", "coef_presenca")
sessoes = votacoes %>%
filter(anov > 2014) %>%
group_by(anov, mesv, diav) %>%
distinct() %>%
group_by(anov, mesv) %>%
summarise(total_mes = n())
tabela_gasto_presenca = tabela_final_mensal %>%
full_join(tabela_final_votacoes[,2:9])
tabela_gasto_presenca$total_presenca[is.na(tabela_gasto_presenca$total_presenca)] = 0
tabela_gasto_presenca$coef_presenca[is.na(tabela_gasto_presenca$coef_presenca)] = 0
names(sessoes) = c("ano", "mes", "total_presenca_mes")
tabela_gasto_presenca = tabela_gasto_presenca %>%
left_join(sessoes)
tabela_gasto_presenca$total_presenca_mes[is.na(tabela_gasto_presenca$total_presenca_mes)] = 0
tabela_gasto_presenca$total_mes = tabela_gasto_presenca$total_presenca_mes
tabela_gasto_presenca = tabela_gasto_presenca %>%
ungroup() %>%
select(-total_presenca_mes)
View(tabela_gasto_presenca)
View(dados)
View(dados)
source("formata_dados.R")
source("prepara_gastos.R")
options(scipen = 50)
library(readr)
cotas = read_csv("../data/final/cota_por_estado.csv")
View(cotas)
dados_gastos = cria_data_frame_2015_2017()
votacoes = read_csv("../data/final/votacoes2.csv")
sessoes = votacoes %>%
filter(anov > 2014) %>%
group_by(anov, mesv, diav) %>%
distinct() %>%
group_by(anov, mesv) %>%
summarise(total_mes = n())
View(sessoes)
View(votacoes)
source("formata_dados.R")
dados_gastos = cria_data_frame_2015_2017()
View(dados_gastos)
dados = dados_gastos
empresas = dados %>%
select(txtCNPJCPF, txtFornecedor) %>%
group_by(txtCNPJCPF, txtFornecedor)
NROW(distinct(empresas$txtCNPJCPF))
NROW(distinct(empresas %>% select(txtCNPJCPF)))
NROW(distinct(empresas %>% ungroup() %>% select(txtCNPJCPF)))
View(empresas)
empresas = dados %>%
select(txtCNPJCPF, txtFornecedor) %>%
group_by(txtCNPJCPF, txtFornecedor) %>%
distinct()
View(empresas)
empresas = dados %>%
select(txtCNPJCPF, txtFornecedor) %>%
group_by(txtCNPJCPF, txtFornecedor) %>%
distinct() %>%
mutate(nome = first(nome))
empresas = dados %>%
select(txtCNPJCPF, txtFornecedor) %>%
group_by(txtCNPJCPF, txtFornecedor) %>%
mutate(txtFornecedor = first(txtFornecedor))
empresas = dados %>%
select(txtCNPJCPF, txtFornecedor) %>%
group_by(txtCNPJCPF, txtFornecedor) %>%
distinct() %>%
group_by(txtCNPJCPF) %>%
mutate(txtFornecedor = first(txtFornecedor))
View(empresas)
empresas = dados %>%
select(txtCNPJCPF, txtFornecedor) %>%
group_by(txtCNPJCPF, txtFornecedor) %>%
distinct() %>%
ungroup() %>%
group_by(txtCNPJCPF) %>%
mutate(txtFornecedor = first(txtFornecedor))
View(votacoes)
empresas = dados %>%
group_by(txtCNPJCPF, txtFornecedor) %>%
mutate(txtFornecedor = first(txtFornecedor))
empresas = dados %>%
group_by(txtCNPJCPF) %>%
mutate(txtFornecedor = first(txtFornecedor))
empresas = dados %>%
select(txtCNPJCPF, txtFornecedor) %>%
group_by(txtCNPJCPF) %>%
mutate(txtFornecedor = first(txtFornecedor))
empresas = dados %>%
select(txtCNPJCPF, txtFornecedor) %>%
group_by(txtCNPJCPF) %>%
mutate(txtFornecedor = first(txtFornecedor)) %>%
group_by(txtCNPJCPF, txtCNPJCPF) %>%
distinct()
empresas = dados %>%
select(txtCNPJCPF, txtFornecedor) %>%
group_by(txtCNPJCPF) %>%
mutate(txtFornecedor = first(txtFornecedor)) %>%
group_by(txtCNPJCPF, txtFornecedor) %>%
distinct()
empresas = dados %>%
select(txtCNPJCPF, txtFornecedor) %>%
group_by(txtCNPJCPF) %>%
mutate(txtFornecedor = first(txtFornecedor)) %>%
group_by(txtCNPJCPF, txtFornecedor) %>%
summarise(n = count())
empresas = dados %>%
select(txtCNPJCPF, txtFornecedor) %>%
group_by(txtCNPJCPF) %>%
mutate(txtFornecedor = first(txtFornecedor)) %>%
group_by(txtCNPJCPF, txtFornecedor) %>%
summarise(n = n())
empresas = dados %>%
select(txtCNPJCPF, txtFornecedor, vlrLiquido) %>%
group_by(txtCNPJCPF) %>%
mutate(txtFornecedor = first(txtFornecedor, soma = sum(vlrLiquido) )) %>%
group_by(txtCNPJCPF, txtFornecedor) %>%
summarise(n = n())
empresas = dados %>%
select(txtCNPJCPF, txtFornecedor, vlrLiquido) %>%
group_by(txtCNPJCPF) %>%
mutate(txtFornecedor = first(txtFornecedor), soma = sum(vlrLiquido) ) %>%
group_by(txtCNPJCPF, txtFornecedor) %>%
summarise(n = n())
empresas = dados %>%
select(txtCNPJCPF, txtFornecedor, vlrLiquido) %>%
group_by(txtCNPJCPF) %>%
mutate(txtFornecedor = first(txtFornecedor), soma = sum(vlrLiquido) ) %>%
group_by(txtCNPJCPF, txtFornecedor, soma) %>%
summarise(n = n())
empresas = dados %>%
select(txtCNPJCPF, txtFornecedor, vlrLiquido) %>%
group_by(txtCNPJCPF) %>%
mutate(txtFornecedor = first(txtFornecedor), soma = sum(vlrLiquido) ) %>%
group_by(txtCNPJCPF, txtFornecedor, soma) %>%
summarise(n = n(), soma = sum(soma))
nrow(dados_gastos %>% filter(is.na(datEmissao)))
dados_gastos = cria_data_frame_2015_2017()
source("formata_dados.R")
source("prepara_gastos.R")
options(scipen = 50)
library(readr)
dados_gastos = cria_data_frame_2015_2017()
nrow(dados_gastos %>% filter(is.na(datEmissao)))
null = dados_gastos %>% filter(is.na(datEmissao))
View(null)
distinct(null$txtDescricao)
unique(null$txtDescricao)
nrow(dados_gastos %>% filter(nossas_categorias == "Telefonia"))
16232/80341
votacoes = read_csv("../data/final/votacoes2.csv")
View(votacoes)
votacoes = read_csv("https://raw.githubusercontent.com/nazareno/dados-da-camara-federal/master/dados/votacoes.csv")
votacoes = read_csv("../data/final/votacoes2.csv")
votacoes = read_csv("https://raw.githubusercontent.com/nazareno/dados-da-camara-federal/master/dados/votacoes.csv")
votacoes = read_csv("../data/final/votacoes2.csv")
votacoes2 = read_csv("../data/final/votacoes2.csv")
votacoes = read_csv("../data/final/votacoes2.csv")
votacoes = read_csv("https://raw.githubusercontent.com/nazareno/dados-da-camara-federal/master/dados/votacoes.csv")
emendas = le_csv_zip("http://portal.convenios.gov.br/images/docs/CGSIS/csv/siconv_emenda.csv.zip")
emendas = le_csv_zip("http://portal.convenios.gov.br/images/docs/CGSIS/csv/siconv_emenda.csv.zip", "emendas")
emendas = le_csv_zip("http://portal.convenios.gov.br/images/docs/CGSIS/csv/siconv_emenda.csv.zip", "sincov_emenda.csv")
emendas = le_csv_zip("http://portal.convenios.gov.br/images/docs/CGSIS/csv/siconv_emenda.csv.zip", "siconv_emenda.csv")
cotas = read_csv("../data/final/cota_por_estado.csv")
tabela_6_gastos_mensal = cria_tabela_6_gastos(dados_gastos)
View(tabela_6_gastos_mensal)
tabela_final_mensal = cria_tabela_final_mensal(dados_gastos)
tabela_final_categoria = cria_tabela_final_categoria(dados_gastos)
tabela_final_votacoes = cria_tabela_final_votacoes(votacoes)
tabela_final_mensal = cria_tabela_final_mensal(dados_gastos)
tabela_final_categoria = cria_tabela_final_categoria(dados_gastos)
tabela_final_votacoes = cria_tabela_final_votacoes(votacoes)
View(votacoes)
View(votacoes2)
View(votacoes)
View(votacoes2)
votacoes$data[1]
as.Date(votacoes$data[1])
as.Date(votacoes$data[1], "DD/MM/YYY")
as.Date(votacoes$data[1], "DD/MM/YYYY")
as.numeric(format(as.Date(votacoes$data[1]), "%Y"))
??as.Date
as.Date(votacoes$data[1], "%D/%M/%Y")
as.Date(votacoes$data[1], "%d/%m/%Y")
as.numeric(format(as.Date(votacoes$data[1]), "%d/%m/%Y"))
as.numeric(format(as.Date(votacoes$data[1]), format = "%d/%m/%Y", "%Y"))
as.numeric(format(as.Date(votacoes$data[1]), format = "%d/%m/%Y"))
format(as.Date(votacoes$data[1]), format = "%d/%m/%Y")
as.Date(votacoes$data[1], "%d/%m/%Y")
as.numeric(format(as.Date(votacoes$data[1], "%d/%m/%Y"), "%Y"))
votacoes$diav = as.numeric(format(as.Date(votacoes$data, "%d/%m/%Y"), "%d"))
votacoes$mesv = as.numeric(format(as.Date(votacoes$data, "%d/%m/%Y"), "%m"))
votacoes$anov = as.numeric(format(as.Date(votacoes$data, "%d/%m/%Y"), "%Y"))
View(votacoes)
source("formata_dados.R")
source("prepara_gastos.R")
source("formata_dados.R")
source("prepara_gastos.R")
options(scipen = 50)
library(readr)
votacoes = read_csv("https://raw.githubusercontent.com/nazareno/dados-da-camara-federal/master/dados/votacoes.csv") %>%
formata_data_votacoes()
votacoes = read_csv("https://raw.githubusercontent.com/nazareno/dados-da-camara-federal/master/dados/votacoes.csv") %>%
formata_data_votacoes()
votacoes = read_csv("https://raw.githubusercontent.com/nazareno/dados-da-camara-federal/master/dados/votacoes.csv") %>% formata_data_votacoes()
View(votacoes)
votacoes = read_csv("https://raw.githubusercontent.com/nazareno/dados-da-camara-federal/master/dados/votacoes.csv") %>% formata_data_votacoes()
source("formata_dados.R")
source("prepara_gastos.R")
options(scipen = 50)
library(readr)
votacoes = read_csv("https://raw.githubusercontent.com/nazareno/dados-da-camara-federal/master/dados/votacoes.csv") %>%
formata_data_votacoes()
View(votacoes)
tabela_final_mensal = cria_tabela_final_mensal(dados_gastos)
dados_gastos = cria_data_frame_2015_2017()
cotas = read_csv("../data/final/cota_por_estado.csv")
emendas = le_csv_zip("http://portal.convenios.gov.br/images/docs/CGSIS/csv/siconv_emenda.csv.zip", "siconv_emenda.csv")
tabela_final_mensal = cria_tabela_final_mensal(dados_gastos)
tabela_final_categoria = cria_tabela_final_categoria(dados_gastos)
tabela_final_votacoes = cria_tabela_final_votacoes(votacoes)
tabela_gastos_presenca = cria_tabela_gastos_presenca(tabela_final_votacoes, tabela_final_mensal)
tabela_gasto_total_anos = cria_tabela_gasto_total_anos(tabela_final_mensal)
tabela_6_gastos = cria_tabela_6_gastos(dados_gastos)
tabela_6_gastos_mensal = cria_tabela_6_gastos(dados_gastos)
top_estourados = cria_top_estourados(tabela_final_mensal)
sessoes_mensal = cria_sessoes_mensal(votacoes)
View(tabela_final_categoria)
View(dados_gastos)
tabela_final_mensal = cria_tabela_final_mensal(dados_gastos)
tabela_final_categoria = cria_tabela_final_categoria(dados_gastos)
tabela_final_votacoes = cria_tabela_final_votacoes(votacoes)
tabela_final_votacoes = cria_tabela_final_votacoes(votacoes)
tabela_gastos_presenca = cria_tabela_gastos_presenca(tabela_final_votacoes, tabela_final_mensal)
tabela_gasto_total_anos = cria_tabela_gasto_total_anos(tabela_final_mensal)
tabela_6_gastos = cria_tabela_6_gastos(dados_gastos)
tabela_6_gastos_mensal = cria_tabela_6_gastos(dados_gastos)
top_estourados = cria_top_estourados(tabela_final_mensal)
sessoes_mensal = cria_sessoes_mensal(votacoes)
View(tabela_final_categoria)
